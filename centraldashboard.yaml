apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    app: dashboard
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/name: dashboard
    kustomize.component: dashboard
  name: dashboard
  namespace: kubeflow
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  labels:
    app: dashboard
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/name: dashboard
    kustomize.component: dashboard
  name: dashboard
  namespace: kubeflow
rules:
- apiGroups:
  - ""
  - app.k8s.io
  resources:
  - applications
  - pods
  - pods/exec
  - pods/log
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - secrets
  - configmaps
  verbs:
  - get
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    app: dashboard
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/name: dashboard
    kustomize.component: dashboard
  name: dashboard
rules:
- apiGroups:
  - ""
  resources:
  - events
  - namespaces
  - nodes
  verbs:
  - get
  - list
  - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  labels:
    app: dashboard
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/name: dashboard
    kustomize.component: dashboard
  name: dashboard
  namespace: kubeflow
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: dashboard
subjects:
- kind: ServiceAccount
  name: dashboard
  namespace: kubeflow
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    app: dashboard
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/name: dashboard
    kustomize.component: dashboard
  name: dashboard
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: dashboard
subjects:
- kind: ServiceAccount
  name: dashboard
  namespace: kubeflow
---
apiVersion: v1
data:
  links: |-
    {
        "menuLinks": [
            {
                "icon": "book",
                "link": "/jupyter/",
                "text": "Notebooks",
                "type": "item"
            },
            {
                "icon": "assessment",
                "link": "/tensorboards/",
                "text": "TensorBoards",
                "type": "item"
            },
            {
                "icon": "device:storage",
                "link": "/volumes/",
                "text": "Volumes",
                "type": "item"
            },
            {
                "icon": "kubeflow:katib",
                "link": "/katib/",
                "text": "Katib Experiments",
                "type": "item"
            },
            {
                "icon": "kubeflow:pipeline-centered",
                "items": [
                    {
                        "link": "/pipeline/#/pipelines",
                        "text": "Pipelines",
                        "type": "item"
                    },
                    {
                        "link": "/pipeline/#/experiments",
                        "text": "Experiments",
                        "type": "item"
                    },
                    {
                        "link": "/pipeline/#/runs",
                        "text": "Runs",
                        "type": "item"
                    },
                    {
                        "link": "/pipeline/#/recurringruns",
                        "text": "Recurring Runs",
                        "type": "item"
                    },
                    {
                        "link": "/pipeline/#/artifacts",
                        "text": "Artifacts",
                        "type": "item"
                    },
                    {
                        "link": "/pipeline/#/executions",
                        "text": "Executions",
                        "type": "item"
                    }
                ],
                "text": "Pipelines",
                "type": "section"
            }
        ],
        "externalLinks": [],
        "documentationItems": [
            {
                "desc": "The Kubeflow website",
                "link": "https://www.kubeflow.org/",
                "text": "Kubeflow Website"
            },
            {
                "desc": "Documentation for Kubeflow Pipelines",
                "link": "https://www.kubeflow.org/docs/components/pipelines/",
                "text": "Kubeflow Pipelines Documentation"
            },
            {
                "desc": "Documentation for Kubeflow Notebooks",
                "link": "https://www.kubeflow.org/docs/components/notebooks/",
                "text": "Kubeflow Notebooks Documentation"
            },
            {
                "desc": "Documentation for Kubeflow Training Operator",
                "link": "https://www.kubeflow.org/docs/components/training/",
                "text": "Kubeflow Training Operator Documentation"
            },
            {
                "desc": "Documentation for Katib",
                "link": "https://www.kubeflow.org/docs/components/katib/",
                "text": "Katib Documentation"
            }
        ],
        "quickLinks": [
            {
                "desc": "Kubeflow Notebooks",
                "link": "/jupyter/new",
                "text": "Create a new Notebook"
            },
            {
                "desc": "Kubeflow Pipelines",
                "link": "/pipeline/#/pipelines",
                "text": "Upload a Pipeline"
            },
            {
                "desc": "Pipelines",
                "link": "/pipeline/#/runs",
                "text": "View Pipeline Runs"
            }
        ]
    }
  settings: |-
    {
      "DASHBOARD_FORCE_IFRAME": true
    }
kind: ConfigMap
metadata:
  labels:
    app: dashboard
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/name: dashboard
    kustomize.component: dashboard
  name: dashboard-config
  namespace: kubeflow
---
apiVersion: v1
data:
  CD_CLUSTER_DOMAIN: cluster.local
  CD_COLLECT_METRICS: "true"
  CD_REGISTRATION_FLOW: "false"
  CD_USERID_HEADER: kubeflow-userid
  CD_USERID_PREFIX: ""
kind: ConfigMap
metadata:
  labels:
    app: dashboard
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/name: dashboard
    kustomize.component: dashboard
  name: dashboard-parameters
  namespace: kubeflow
---
apiVersion: v1
kind: Service
metadata:
  labels:
    app: dashboard
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/name: dashboard
    kustomize.component: dashboard
  name: dashboard
  namespace: kubeflow
  ports:
  - port: 80
    protocol: TCP
    targetPort: 8082
  selector:
    app: dashboard
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/name: dashboard
    kustomize.component: dashboard
  sessionAffinity: None
  type: ClusterIP
---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: dashboard
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/name: dashboard
    kustomize.component: dashboard
  name: dashboard
  namespace: kubeflow
  replicas: 1
  selector:
    matchLabels:
      app: dashboard
      app.kubernetes.io/component: dashboard
      app.kubernetes.io/name: dashboard
      kustomize.component: dashboard
  template:
    metadata:
      labels:
        app: dashboard
        app.kubernetes.io/component: dashboard
        app.kubernetes.io/name: dashboard
        kustomize.component: dashboard
        sidecar.istio.io/inject: "true"
      containers:
      - env:
        - name: USERID_HEADER
          value: kubeflow-userid
        - name: USERID_PREFIX
          value: ""
        - name: PROFILES_KFAM_SERVICE_HOST
          value: profiles-kfam.kubeflow
        - name: REGISTRATION_FLOW
          value: "false"
        - name: DASHBOARD_CONFIGMAP
          value: dashboard-config
        - name: LOGOUT_URL
          value: /oauth2/sign_out
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: COLLECT_METRICS
          value: CD_COLLECT_METRICS
        image: ghcr.io/kubeflow/dashboard/dashboard:latest
        imagePullPolicy: IfNotPresent
        livenessProbe:
          httpGet:
            path: /healthz
            port: 8082
          initialDelaySeconds: 30
          periodSeconds: 30
        name: dashboard
        ports:
        - containerPort: 8082
          protocol: TCP
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          runAsNonRoot: true
          runAsUser: 1000
          seccompProfile:
            type: RuntimeDefault
      serviceAccountName: dashboard
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app: dashboard
    app.kubernetes.io/component: dashboard
    app.kubernetes.io/name: dashboard
    kustomize.component: dashboard
  name: dashboard
  namespace: kubeflow
  ingress:
  - from:
    - namespaceSelector:
        matchExpressions:
        - key: kubernetes.io/metadata.name
          operator: In
          values:
          - istio-system
    - podSelector: {}
  podSelector:
    matchExpressions:
    - key: app
      operator: In
      values:
      - dashboard
  policyTypes:
  - Ingress
